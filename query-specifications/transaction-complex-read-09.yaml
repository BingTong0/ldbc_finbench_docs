workload: Transaction
operation: complex-read
number: 9
title: Transfer-outs distribution in transfer trace
description: |
  Given an account(*a*), find the ratio(*ratio1* and *ratio2*) of amount of each transfer
  over the sum at 1 step and at 2 steps. Specifically, *ratio1* means the ratio of the
  amount over the sum of *edge1* amount for each transfer *edge1*, and *ratio2* means
  the amount of each *edge2* over the amount of upstream transfer(*edge1*). Note that
  the transfer trace of *edge1*, *edge2* are in ascending order in terms of timestamp and
  in descending order in terms of amount. And the transfers(*edge1* and *edge2*) are
  filtered by *threshold*. Return the ratios(*ratio1* and *ratio2*) in descending order.
parameters:
  - name: id
    type: ID
    description: id of the start Account
  - name: threshold
    type: 64-bit Integer
    description: threshold of transfer amount
result:
  - name: ratio1
    type: 32-bit float
  - name: ratio2
    type: 32-bit float
sort:
  - name: ratio1
    direction: desc
  - name: ratio2
    direction: desc
choke_points: [0.0]
relevance: |
  This query is a typical main stream of fund transfer-out trace case in risk control.
